2025-01-12 15:13:33,205 P92100 INFO FuxiCTR version: 2.3.6
2025-01-12 15:13:33,205 P92100 INFO Params: {
    "batch_size": "128",
    "data_format": "npz",
    "data_root": "../../data/",
    "dataset_id": "tiny_npz",
    "debug_mode": "False",
    "early_stop_patience": "2",
    "embedding_dim": "4",
    "embedding_regularizer": "0",
    "epochs": "1",
    "eval_steps": "None",
    "feature_config": "None",
    "feature_specs": "None",
    "fs1_context": "['userid']",
    "fs2_context": "['adgroup_id', 'cate_id']",
    "fs_hidden_units": "[64, 64]",
    "gpu": "0",
    "group_id": "None",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "mlp1_batch_norm": "False",
    "mlp1_dropout": "0",
    "mlp1_hidden_activations": "relu",
    "mlp1_hidden_units": "[64, 32]",
    "mlp2_batch_norm": "False",
    "mlp2_dropout": "0",
    "mlp2_hidden_activations": "relu",
    "mlp2_hidden_units": "[64, 64, 64]",
    "model": "FinalMLP",
    "model_id": "FinalMLP_test",
    "model_root": "./checkpoints/",
    "monitor": "AUC",
    "monitor_mode": "max",
    "net_regularizer": "0",
    "num_heads": "2",
    "num_workers": "3",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../data/tiny_npz/test.npz",
    "train_data": "../../data/tiny_npz/train.npz",
    "use_features": "None",
    "use_fs": "True",
    "valid_data": "../../data/tiny_npz/valid.npz",
    "verbose": "1"
}
2025-01-12 15:13:33,206 P92100 INFO Load feature_map from json: ../../data/tiny_npz/feature_map.json
2025-01-12 15:13:33,207 P92100 INFO Set column index...
2025-01-12 15:13:33,207 P92100 INFO Feature specs: {
    "adgroup_id": "{'source': 'item', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 96}",
    "age_level": "{'source': 'user', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 7}",
    "brand": "{'source': 'item', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 67}",
    "campaign_id": "{'source': 'item', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 99}",
    "cate_id": "{'source': 'item', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 49}",
    "cms_group_id": "{'source': 'user', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 11}",
    "cms_segid": "{'source': 'user', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 11}",
    "customer": "{'source': 'item', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 98}",
    "final_gender_code": "{'source': 'user', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "occupation": "{'source': 'user', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "pid": "{'source': 'context', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "pvalue_level": "{'source': 'user', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 4}",
    "shopping_level": "{'source': 'user', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 5}",
    "userid": "{'source': 'user', 'type': 'categorical', 'padding_idx': 0, 'vocab_size': 26}"
}
2025-01-12 15:13:33,740 P92100 INFO Total number of parameters: 37938.
2025-01-12 15:13:33,740 P92100 INFO Loading datasets...
2025-01-12 15:13:33,742 P92100 INFO Train samples: total/100, blocks/1
2025-01-12 15:13:33,743 P92100 INFO Validation samples: total/100, blocks/1
2025-01-12 15:13:33,743 P92100 INFO Loading train and validation data done.
2025-01-12 15:13:33,743 P92100 INFO Start training: 1 batches/epoch
2025-01-12 15:13:33,743 P92100 INFO ************ Epoch=1 start ************
2025-01-12 15:13:35,671 P92100 INFO Train loss: 0.693145
2025-01-12 15:13:35,671 P92100 INFO Evaluation @epoch 1 - batch 1: 
2025-01-12 15:13:42,632 P92100 INFO [Metrics] AUC: 0.908854
2025-01-12 15:13:42,633 P92100 INFO Save best model: monitor(max)=0.908854
2025-01-12 15:13:47,642 P92100 INFO ************ Epoch=1 end ************
2025-01-12 15:13:47,642 P92100 INFO Training finished.
2025-01-12 15:13:47,643 P92100 INFO Load best model: /Users/aysenilozdemir/Downloads/FuxiCTR-main/model_zoo/FinalMLP/checkpoints/tiny_npz/FinalMLP_test.model
2025-01-12 15:13:47,649 P92100 INFO ****** Validation evaluation ******
2025-01-12 15:13:54,442 P92100 INFO [Metrics] logloss: 0.685982 - AUC: 0.908854
2025-01-12 15:13:54,530 P92100 INFO ******** Test evaluation ********
2025-01-12 15:13:54,530 P92100 INFO Loading datasets...
2025-01-12 15:13:54,532 P92100 INFO Test samples: total/100, blocks/1
2025-01-12 15:13:54,532 P92100 INFO Loading test data done.
2025-01-12 15:14:01,237 P92100 INFO [Metrics] logloss: 0.685982 - AUC: 0.908854
